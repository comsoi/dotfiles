emulate -L zsh

[[ -z "$1" || -z "$2" || ! -d "$2" || ":${(P)1}:" == *":$2:"* ]] && return
if [[ "$3" == "prefix" ]] {
	typeset -g $1="$2${(P)1:+:${(P)1}}"
} else {
	typeset -g $1="${(P)1:+${(P)1}:}$2"
}
